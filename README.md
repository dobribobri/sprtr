**SPRTR v2.0.1**

![](/home/dobri/projects/sprtr/pics/0.png)

[dobrix95@gmail.com](mailto:dobrix95@gmail.com), [Egorov_DP@cplire.ru](mailto:Egorov_DP@cplire.ru)

Разработана новая версия приложения SPRTR для обработки и визуализации данных спектральных пирометров. В новой версии SPRTR v2.0.1 этапы обработки полученных данных выполнены в виде отдельных вкладок программы и расположены последовательно:

1. «Синхронизация» каналов по времени (рис. 1). На данном этапе программа позволяет автоматически определить относительные временные смещения в выбранных каналах пирометра.
2. «Калибровка» (рис. 2). На этапе калибровки пользователю предлагается загрузить данные калибровочного сеанса и для выбранных каналов провести в автоматическом режиме их относительную или абсолютную калибровку (установить калибровочный коэффициент) с учетом известной температуры эталона и его излучательной способности.
3. «Эксперимент» (рис. 3). Программа позволяет загрузить данные эксперимента и для некоторого интервала времени выполнить расчет температуры (или спектров интенсивности излучения) измеряемого образца при заданной зависимости его излучательной способности от длины волны. Расчет временного хода температуры образца производится для выбранных каналов с учетом полученных на предыдущих этапах значений калибровочных коэффициентов и временных смещений.

Реализована возможность возвращения к предыдущим этапам (вкладкам). Интерфейс программы полностью русифицирован.

![](/home/dobri/projects/sprtr/pics/1.png)

Рис. 1. Вкладка «Синхронизация»

![](/home/dobri/projects/sprtr/pics/2.png)

Рис. 2. Вкладка «Калибровка»

![](/home/dobri/projects/sprtr/pics/3.png)

Рис. 3. Вкладка «Эксперимент»

Процесс загрузки данных в приложение проиллюстрирован на рис. 4-9 на примере этапа 2 «Калибровка».

![](/home/dobri/projects/sprtr/pics/4.png)

Рис. 4. Для загрузки данных отдельного канала нажмем на кнопку с номером этого канала

![](/home/dobri/projects/sprtr/pics/5.png)

Рис. 5. В открывшемся диалоговом окне выберем файл .txt или .wfm

![](/home/dobri/projects/sprtr/pics/6.png)

Рис. 6. Для загрузки данных по всем или нескольким каналам нажмем на кнопку «Загрузить»

![](/home/dobri/projects/sprtr/pics/7.png)

Рис. 7. В появившемся диалоговом окне можно выбрать один или несколько файлов с одинаковым расширением (.dat / .csv / .txt / .wfm)

![](/home/dobri/projects/sprtr/pics/8.png)

Рис. 8. Предлагаемые расширения

![](/home/dobri/projects/sprtr/pics/9.png)

Рис. 9. В случае успешного прочтения выбранных файлов и загрузки данных в канал, кнопка с соответствующим номером канала подсвечивается зеленым цветом.

Просмотреть загруженные данные в их исходном виде всегда можно по нажатию кнопки «Показать исходные данные» (рис. 10).

![](/home/dobri/projects/sprtr/pics/10.png)

Рис. 10. Кнопка «Показать исходные данные»

![](/home/dobri/projects/sprtr/pics/11.png)

Рис. 11. Отображение исходных данных

При загрузке данных на любом из этапов 1-3 возможно выполнить интерполяцию сигнала с произвольным разрешением по времени (рис. 12).

![](/home/dobri/projects/sprtr/pics/12.png)

Рис. 12. Параметры интерполяции при загрузке файлов

Помимо интерполяции реализована предварительная выборочная фильтрация загруженных данных с помощью различных фильтров (рис. 13), представленных в меню «Инструменты», с возможностью их параметризации (рис. 14). Меню «Инструменты» (рис. 15) также включает ряд дополнительных функций, которые могут быть использованы вне зависимости от текущего этапа обработки.

![](/home/dobri/projects/sprtr/pics/13.png)

Рис. 13. Фильтрация

![](/home/dobri/projects/sprtr/pics/14.png)

Рис. 14. Диалоговое окно «Параметры фильтров»

![](/home/dobri/projects/sprtr/pics/15.png)

Рис. 15. Меню «Инструменты»

На рис. 16. показан результат применения фильтра Савицкого-Голея (Savgol) к данным калибровочного сеанса по нажатию на «Инструменты» → «Применить фильтр» → «Фильтр Савицкого-Голея (Savgol)» при открытой вкладке «Калибровка».

![](/home/dobri/projects/sprtr/pics/16.png)

Рис. 16. Результат фильтрации исходных данных калибровочного сеанса из рис. 11

Для автоматического расчета калибровочных коэффициентов по данным загруженного калибровочного сеанса необходимо (на вкладке «Калибровка») выбрать тип калибровки (относительная / абсолютная), установить параметры калибровки, т.е. температуру эталона и его излучательную способность, и нажать на кнопку «Применить». Аналогично, для автоматического определения временных сдвигов в каналах необходимо перейти на вкладку «Синхронизация», загрузить данные и нажать на кнопку «Применить». Калибровочные коэффициенты / временные сдвиги будут рассчитаны только в тех каналах, которые отмечены галочкой (рядом с кнопкой «Применить» на соответствующей вкладке).

Результаты прохождения этапов «Синхронизация» и «Калибровка», т.е. полученные величины временных сдвигов, а также актуальные значения калибровочных коэффициентов, сохраняются в текущей сессии пользователя и могут быть просмотрены на дополнительной вкладке «Основное» (рис. 17). Реализована возможность изменения установленных временных сдвигов и калибровочных коэффициентов вручную. Вкладка «Основное» также предоставляет удобный интерфейс для изменения конфигурации используемых каналов, т.е. их порядкового соответствия заданным длинам волн; для заполнения значений коэффициентов усиления/ослабления, применяемых к сигналам с АЦП в этих каналах.

![](/home/dobri/projects/sprtr/pics/17.png)

Рис. 17. Вкладка «Основное»

Одной из ключевых особенностей SPRTR v2.0.0 является возможность сохранения текущего прогресса в работе с данными. Текущая сессия пользователя, а именно настройки программы и агрегированные параметры с вкладки «Основное», а также данные сеансов, загруженные в ходе этапов 1-3, могут быть сохранены по нажатию кнопки «Сохранить» в выпадающем меню «Файл» (рис. 18). Аналогичным образом, прогресс пользователя может быть восстановлен по нажатию кнопки «Открыть сессию…». Для хранения сессии пользователя выбран формат файла JSON.

![](/home/dobri/projects/sprtr/pics/18.png)

Рис. 18. Меню «Файл»

Приведем пример расчета температуры и спектров интенсивности излучения некоторого экспериментального образца. Предположим, что заранее проведена синхронизация каналов и установлены актуальные значения калибровочных коэффициентов. Перейдем на вкладку «Эксперимент» и загрузим данные измерительного сеанса (рис. 19). Поскольку в области «Загрузка данных» установлен флажок «Интерполировать», при загрузке файлов будет выполнена интерполяция с соответствующим количеством точек (1024).

![](/home/dobri/projects/sprtr/pics/19.png)

Рис. 19. Данные измерительного сеанса успешно загружены

Просмотрим загруженные данные (рис. 20), нажав на кнопку «Показать исходные данные». Здесь данные отображаются без учета установленных временных смещений, калибровочных коэффициентов и коэффициентов усиления.

![](/home/dobri/projects/sprtr/pics/20.png)

Рис. 20. Исходные данные измерительного сеанса

Выберем временной интервал, для которого будет рассчитан временной ход температуры образца. Убедимся, что в меню «Инструменты» установлен флажок «Выбор временного интервала» (см. рис. 15). Выделение временного интервала на графике исходных данных измерительного сеанса (рис. 20) осуществляется путем зажатия левой кнопки мыши для обозначения начала интервала, перетаскивания указателя мыши и затем отжатия левой кнопки мыши для обозначения конца интервала (рис. 21).

![](/home/dobri/projects/sprtr/pics/21.png)

Рис. 21. Выделение временного интервала

Зададим параметры расчета температуры (рис. 22):

1) Интерполяция. Полученные в результате расчета в заданном временном интервале экспериментальные значения температуры также могут быть интерполированы.

2) При использовании SPRTR v2.0.1 в ОС Linux расчет временного хода температуры может быть распараллелен на доступное количество ядер (CPU-bound параллелизм). Если приложение используется в ОС Windows, флажок «Распараллелить» необходимо снять.

![](/home/dobri/projects/sprtr/pics/22.png)

Рис. 22. Параметры расчета температуры

Зададим излучательную способность. По нажатию на кнопку «Излучательная способность образца» откроется диалоговое окно выбора файла. В качестве файла необходимо выбрать Excel-таблицу (.xls, .xlsx), имеющую следующую структуру (рис. 23)

![](/home/dobri/projects/sprtr/pics/23.png)

Рис. 23. Таблица коэффициентов излучения

_Здесь первый столбец - длина волны в мкм, второй столбец - значение коэффициента излучения._

Выберем множество каналов, которые будут использоваться для аппроксимации Планковских спектров и расчета температуры (рис. 24). Нажмем «Рассчитать».

![](/home/dobri/projects/sprtr/pics/24.png)

Рис. 24. Выбор каналов для расчета температуры и кнопка «Рассчитать»

Для просмотра результатов расчета временного хода температуры на фоне обработанных (синхронизованных по времени и откалиброванных) данных измерительного сеанса (рис. 25) необходимо нажать на кнопку «График».

Для отображения вычисленных (аппроксимированных по данным измерительного сеанса) спектров интенсивности излучения образца (рис. 26) необходимо отметить флажок «3D спектры».

![](/home/dobri/projects/sprtr/pics/25.png)

Рис. 25. Временной ход вычисленной температуры на фоне обработанных данных измерительного сеанса

![](/home/dobri/projects/sprtr/pics/26.png)

Рис. 26. Аппроксимированные спектры интенсивности излучения образца (пример)

Вычисленные значения температуры могут быть экспортированы в файл Excel (рис. 27).

![](/home/dobri/projects/sprtr/pics/27.png)

Рис. 27. Экспорт таблицы температур

SPRTR v2.0.1 является кросс-платформенным приложением, написанным на языке программирования Python 3.10 с использованием технологии ООП. Интерфейс приложения создан на базе событийно-ориентированной графической библиотеки tkinter и фреймворка formation-studio. Ядро приложения использует такие программные библиотеки и средства языка как numpy, scipy, pandas, pillow, Cython, statsmodels, multiprocessing и tqdm. Для визуализации данных измерений используется библиотека matplotlib. Исполняемый файл для ОС Windows 10 Pro x64 20H2 получен с помощью утилиты pyinstaller. Все вышеупомянутые библиотеки распространяются с открытым исходным кодом.